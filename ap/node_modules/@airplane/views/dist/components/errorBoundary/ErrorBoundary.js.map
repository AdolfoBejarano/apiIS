{"version":3,"file":"ErrorBoundary.js","sources":["../../../src/components/errorBoundary/ErrorBoundary.tsx"],"sourcesContent":["import { uniqueId } from \"lodash-es\";\nimport hash from \"object-hash\";\nimport { Component, ErrorInfo, ReactNode } from \"react\";\n\nimport { sendViewMessage } from \"message/sendViewMessage\";\n\nimport { ErrorFallback } from \"./ErrorFallback\";\n\nexport type Props = {\n  children: ReactNode;\n  fallback?: ReactNode;\n};\n\n/**\n * ErrorBoundary is a component that catches errors in its children and displays a fallback UI.\n *\n * This is used in the builder to wrap the entire View to catch any errors that aren't caught by\n * component error boundaries.\n */\nexport class ErrorBoundary extends Component<\n  Props,\n  { error?: Error; errorInfo?: ErrorInfo; errorID?: string }\n> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    const errorID = uniqueId();\n    this.setState({ error, errorInfo, errorID });\n    sendViewMessage({\n      type: \"console\",\n      id: errorID,\n      messageType: \"error\",\n      message: error.message,\n      hash: hash(error),\n      time: Date.now(),\n    });\n  }\n\n  render() {\n    if (this.state.error && this.state.errorInfo && this.state.errorID) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n      return (\n        <ErrorFallback\n          errorID={this.state.errorID}\n          error={this.state.error}\n          errorInfo={this.state.errorInfo}\n        />\n      );\n    }\n    return this.props.children;\n  }\n}\n"],"names":["ErrorBoundary","Component","constructor","props","state","componentDidCatch","error","errorInfo","errorID","uniqueId","setState","type","id","messageType","message","hash","time","Date","now","render","fallback","children"],"mappings":";;;;;;AAmBO,MAAMA,sBAAsBC,UAGjC;AAAA,EACAC,YAAYC,OAAc;AACxB,UAAMA,KAAK;AACX,SAAKC,QAAQ;EACf;AAAA,EAEAC,kBAAkBC,OAAcC,WAAsB;AACpD,UAAMC,UAAUC;AAChB,SAAKC,SAAS;AAAA,MAAEJ;AAAAA,MAAOC;AAAAA,MAAWC;AAAAA,IAAAA,CAAS;AAC3B,oBAAA;AAAA,MACdG,MAAM;AAAA,MACNC,IAAIJ;AAAAA,MACJK,aAAa;AAAA,MACbC,SAASR,MAAMQ;AAAAA,MACfC,MAAMA,KAAKT,KAAK;AAAA,MAChBU,MAAMC,KAAKC,IAAI;AAAA,IAAA,CAChB;AAAA,EACH;AAAA,EAEAC,SAAS;AACH,QAAA,KAAKf,MAAME,SAAS,KAAKF,MAAMG,aAAa,KAAKH,MAAMI,SAAS;AAC9D,UAAA,KAAKL,MAAMiB,UAAU;AACvB,eAAO,KAAKjB,MAAMiB;AAAAA,MACpB;AACA,aACG,oBAAA,eAAA,EACC,SAAS,KAAKhB,MAAMI,SACpB,OAAO,KAAKJ,MAAME,OAClB,WAAW,KAAKF,MAAMG,UACtB,CAAA;AAAA,IAEN;AACA,WAAO,KAAKJ,MAAMkB;AAAAA,EACpB;AACF;"}