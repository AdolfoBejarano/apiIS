{"version":3,"file":"reducer.js","sources":["../../../../src/state/components/input/reducer.ts"],"sourcesContent":["import { isEqual } from \"lodash-es\";\n\nimport { runValidate } from \"./runValidation\";\nimport { ValidateFnProp } from \"./types\";\n\nexport type InputState<TValue> = {\n  value?: TValue;\n  disabled: boolean;\n  errors: string[];\n  showErrors: boolean;\n};\n\nexport type InputAction<TValue> =\n  | { type: \"setValue\"; value: TValue }\n  | { type: \"setDisabled\"; disabled?: boolean }\n  | { type: \"validate\"; required?: boolean; validate?: ValidateFnProp<TValue> }\n  | { type: \"setShowErrors\"; showErrors: boolean }\n  | { type: \"reset\"; initialValue: TValue; initialDisabled: boolean };\n\nexport const inputReducer = <TValue>(\n  state: InputState<TValue>,\n  action: InputAction<TValue>,\n): InputState<TValue> => {\n  switch (action.type) {\n    case \"setValue\": {\n      const { value } = action;\n      return { ...state, value };\n    }\n    case \"setDisabled\": {\n      let { disabled } = action;\n      if (disabled == null) disabled = true;\n      return { ...state, disabled };\n    }\n    case \"validate\": {\n      const { required, validate } = action;\n      const { value, errors } = state;\n      const newErrors = runValidate(value, { required, validate });\n      if (isEqual(errors, newErrors)) {\n        return state;\n      } else {\n        return { ...state, errors: newErrors };\n      }\n    }\n    case \"setShowErrors\": {\n      const { showErrors } = action;\n      if (showErrors === state.showErrors) {\n        return state;\n      }\n      return { ...state, showErrors };\n    }\n    case \"reset\": {\n      const { initialValue, initialDisabled } = action;\n      return {\n        value: initialValue,\n        disabled: initialDisabled,\n        errors: [],\n        showErrors: false,\n      };\n    }\n    default:\n      throw new Error(\"invalid action\");\n  }\n};\n"],"names":["inputReducer","state","action","type","value","disabled","required","validate","errors","newErrors","runValidate","isEqual","showErrors","initialValue","initialDisabled","Error"],"mappings":";;AAmBaA,MAAAA,eAAe,CAC1BC,OACAC,WACuB;AACvB,UAAQA,OAAOC,MAAI;AAAA,IACjB,KAAK,YAAY;AACT,YAAA;AAAA,QAAEC;AAAAA,MAAUF,IAAAA;AACX,aAAA;AAAA,QAAE,GAAGD;AAAAA,QAAOG;AAAAA,MAAAA;AAAAA,IACrB;AAAA,IACA,KAAK,eAAe;AACd,UAAA;AAAA,QAAEC;AAAAA,MAAaH,IAAAA;AACnB,UAAIG,YAAY;AAAiB,mBAAA;AAC1B,aAAA;AAAA,QAAE,GAAGJ;AAAAA,QAAOI;AAAAA,MAAAA;AAAAA,IACrB;AAAA,IACA,KAAK,YAAY;AACT,YAAA;AAAA,QAAEC;AAAAA,QAAUC;AAAAA,MAAaL,IAAAA;AACzB,YAAA;AAAA,QAAEE;AAAAA,QAAOI;AAAAA,MAAWP,IAAAA;AACpBQ,YAAAA,YAAYC,YAAYN,OAAO;AAAA,QAAEE;AAAAA,QAAUC;AAAAA,MAAAA,CAAU;AACvDI,UAAAA,QAAQH,QAAQC,SAAS,GAAG;AACvBR,eAAAA;AAAAA,MAAAA,OACF;AACE,eAAA;AAAA,UAAE,GAAGA;AAAAA,UAAOO,QAAQC;AAAAA,QAAAA;AAAAA,MAC7B;AAAA,IACF;AAAA,IACA,KAAK,iBAAiB;AACd,YAAA;AAAA,QAAEG;AAAAA,MAAeV,IAAAA;AACnBU,UAAAA,eAAeX,MAAMW,YAAY;AAC5BX,eAAAA;AAAAA,MACT;AACO,aAAA;AAAA,QAAE,GAAGA;AAAAA,QAAOW;AAAAA,MAAAA;AAAAA,IACrB;AAAA,IACA,KAAK,SAAS;AACN,YAAA;AAAA,QAAEC;AAAAA,QAAcC;AAAAA,MAAoBZ,IAAAA;AACnC,aAAA;AAAA,QACLE,OAAOS;AAAAA,QACPR,UAAUS;AAAAA,QACVN,QAAQ,CAAE;AAAA,QACVI,YAAY;AAAA,MAAA;AAAA,IAEhB;AAAA,IACA;AACQ,YAAA,IAAIG,MAAM,gBAAgB;AAAA,EACpC;AACF;"}