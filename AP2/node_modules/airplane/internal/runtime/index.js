"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getRuntime = exports.registerRuntime = void 0;
const dev_1 = require("./dev");
const standard_1 = require("./standard");
const runtimeMap = {
    standard: standard_1.runtime,
    dev: dev_1.runtime,
};
// registerRuntime registers a new runtime with a given kind.
//
// It returns a function that can be called, if necessary, to unregister the runtime.
const registerRuntime = (kind, runtime) => {
    if (kind in runtimeMap) {
        throw new Error(`A runtime for "${kind}" has already been registered.`);
    }
    runtimeMap[kind] = runtime;
    return () => {
        delete runtimeMap[kind];
    };
};
exports.registerRuntime = registerRuntime;
const getRuntime = () => {
    var _a;
    const kindStr = (_a = globalThis.process) === null || _a === void 0 ? void 0 : _a.env.AIRPLANE_RUNTIME;
    if (kindStr != null) {
        const runtime = runtimeMap[kindStr];
        if (runtime != null) {
            return runtime;
        }
    }
    return standard_1.runtime;
};
exports.getRuntime = getRuntime;
